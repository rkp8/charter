<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="https://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  </head>
<body>

<button id = "update">Update Chart</button>


<div class="ct-chart ct-perfect-fourth"></div>

<script>


var myChart;
var retrievedLabels;
var getLabels = $.get(' http://127.0.0.1:5000/labels');

getLabels.done(function(results){


    retrievedLabels =
    [results.results]





});


var getData = $.get(' http://127.0.0.1:5000/data');

getData.done(function(results){

var listLabel = retrievedLabels.toString();
   console.log("list " + listLabel);

var labelarray = listLabel.split(',');

   console.log("labels " + labelarray[0]);

    var data = {
  // A labels array that can contain any sort of values
  labels: [labelarray[0], labelarray[1], labelarray[2], labelarray[3], labelarray[4]],
  // Our series array that contains series objects or in this case series data arrays
  series: [
    results.results
  ]
};

var options = {
    width : 800,
    height : 600
    }

// Create a new line chart object where as first parameter we pass in a selector
// that is resolving to our chart container element. The Second parameter
// is the actual data object.
myChart = new Chartist.Line('.ct-chart', data, options);
});

function updateChart(){


var getLabels = $.get(' http://127.0.0.1:5000/labels');

getLabels.done(function(results){


     retrievedLabels =
    [results.results]
    console.log("labels " + retrievedLabels);


});


var getData = $.get(' http://127.0.0.1:5000/data');

getData.done(function(results){

var listLabel = retrievedLabels.toString();
   console.log("list " + listLabel);

var labelarray = listLabel.split(',');

   console.log("labels " + labelarray[0]);

    var data = {
  // A labels array that can contain any sort of values
  labels: [labelarray[0], labelarray[1], labelarray[2], labelarray[3], labelarray[4]],
  // Our series array that contains series objects or in this case series data arrays
  series: [
    results.results
  ]
};

myChart.update(data);


});



   }

$("#update").on('click', updateChart);


</script>
</body>
</html>




